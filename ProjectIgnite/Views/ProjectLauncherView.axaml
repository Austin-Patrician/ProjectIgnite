<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:ProjectIgnite.ViewModels"
             mc:Ignorable="d" d:DesignWidth="1200" d:DesignHeight="800"
             x:Class="ProjectIgnite.Views.ProjectLauncherView"
             x:DataType="vm:ProjectLauncherViewModel">

    <Design.DataContext>
        <vm:ProjectLauncherViewModel/>
    </Design.DataContext>

    <UserControl.Styles>
        <!-- é¡¹ç›®å¡ç‰‡æ ·å¼ -->
        <Style Selector="Border.ProjectCard">
            <Setter Property="Background" Value="White"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BoxShadow" Value="0 2 8 0 #20000000"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="8"/>
        </Style>

        <!-- çŠ¶æ€æŒ‡ç¤ºå™¨æ ·å¼ -->
        <Style Selector="Ellipse.StatusIndicator">
            <Setter Property="Width" Value="12"/>
            <Setter Property="Height" Value="12"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>

        <Style Selector="Ellipse.StatusIndicator.Ready">
            <Setter Property="Fill" Value="#6c757d"/>
        </Style>

        <Style Selector="Ellipse.StatusIndicator.Running">
            <Setter Property="Fill" Value="#28a745"/>
        </Style>

        <Style Selector="Ellipse.StatusIndicator.Error">
            <Setter Property="Fill" Value="#dc3545"/>
        </Style>

        <!-- æŒ‰é’®æ ·å¼ -->
        <Style Selector="Button.ActionButton">
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="4,2"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>

        <Style Selector="Button.StartButton">
            <Setter Property="Background" Value="#28a745"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style Selector="Button.StopButton">
            <Setter Property="Background" Value="#dc3545"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style Selector="Button.ConfigButton">
            <Setter Property="Background" Value="#007bff"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <!-- æ ‡ç­¾é¡µæ ·å¼ -->
        <Style Selector="TabItem">
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
        </Style>
    </UserControl.Styles>

    <Grid>
        <Grid.RowDefinitions>
            <!-- å·¥å…·æ  -->
            <RowDefinition Height="Auto"/>
            <!-- ä¸»å†…å®¹åŒºåŸŸ -->
            <RowDefinition Height="*"/>
            <!-- çŠ¶æ€æ  -->
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- å·¥å…·æ  -->
        <Border Grid.Row="0" Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                BorderThickness="0,0,0,1" Padding="16,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- å·¦ä¾§æŽ§ä»¶ -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12">
                    <TextBlock Text="ðŸš€" FontSize="20" VerticalAlignment="Center"/>
                    <TextBlock Text="Project Launcher" FontSize="16" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    
                    <!-- ç­›é€‰æŽ§ä»¶ -->
                    <ComboBox ItemsSource="{Binding ProjectTypes}"
                              SelectedItem="{Binding SelectedProjectType}"
                              MinWidth="120"/>
                    
                    <TextBox Watermark="æœç´¢é¡¹ç›®..." 
                             Text="{Binding FilterText}"
                             MinWidth="200"/>
                </StackPanel>

                <!-- å³ä¾§æŒ‰é’® -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="8">
                    <Button Classes="ActionButton" Command="{Binding RefreshCommand}"
                            ToolTip.Tip="åˆ·æ–°æ•°æ®">
                        <TextBlock Text="ðŸ”„"/>
                    </Button>
                    <Button Classes="ActionButton" Command="{Binding CleanupPortsCommand}"
                            ToolTip.Tip="æ¸…ç†ç«¯å£">
                        <TextBlock Text="ðŸ§¹"/>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <TabControl Grid.Row="1" Margin="16">
            <!-- é¡¹ç›®å¯åŠ¨å™¨æ ‡ç­¾é¡µ -->
            <TabItem Header="é¡¹ç›®å¯åŠ¨å™¨">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <!-- é¡¹ç›®åˆ—è¡¨ -->
                        <ColumnDefinition Width="2*"/>
                        <!-- åˆ†éš”çº¿ -->
                        <ColumnDefinition Width="Auto"/>
                        <!-- æŽ§åˆ¶é¢æ¿ -->
                        <ColumnDefinition Width="1*"/>
                    </Grid.ColumnDefinitions>

                    <!-- é¡¹ç›®åˆ—è¡¨ -->
                    <Border Grid.Column="0" Classes="ProjectCard" Margin="0,0,8,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- æ ‡é¢˜ -->
                            <TextBlock Grid.Row="0" Text="å¯ç”¨é¡¹ç›®" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>

                            <!-- é¡¹ç›®åˆ—è¡¨ -->
                            <ScrollViewer Grid.Row="1">
                                <Grid>
                                    <!-- é¡¹ç›®åŠ è½½æŒ‡ç¤ºå™¨ -->
                                    <StackPanel IsVisible="{Binding IsProjectsLoading}" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"
                                               Margin="20">
                                        <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                                        <TextBlock Text="æ­£åœ¨åŠ è½½é¡¹ç›®..." HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                    </StackPanel>

                                    <!-- ç©ºçŠ¶æ€æç¤º -->
                                    <StackPanel IsVisible="{Binding ProjectSources.Count, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}"
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"
                                               Margin="20">
                                        <TextBlock Text="ðŸ“" FontSize="48" HorizontalAlignment="Center" Opacity="0.5"/>
                                        <TextBlock Text="æš‚æ— å¯ç”¨é¡¹ç›®" HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.7"/>
                                        <TextBlock Text="è¯·å…ˆåœ¨é¡¹ç›®æºé¡µé¢æ·»åŠ é¡¹ç›®" HorizontalAlignment="Center" FontSize="12" Opacity="0.5"/>
                                    </StackPanel>

                                    <!-- é¡¹ç›®åˆ—è¡¨ -->
                                    <ItemsControl ItemsSource="{Binding ProjectSources}" IsVisible="{Binding ProjectSources.Count, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=0}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate x:DataType="vm:ProjectLauncherProjectSourceViewModel">
                                                <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                                                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <!-- é¡¹ç›®ä¿¡æ¯ -->
                                                        <StackPanel Grid.Column="0">
                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                <Ellipse Classes="StatusIndicator Ready"/>
                                                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                                                <Border Background="#e9ecef" CornerRadius="3" Padding="4,2">
                                                                    <TextBlock Text="{Binding ProjectType}" FontSize="10"/>
                                                                </Border>
                                                            </StackPanel>
                                                            <TextBlock Text="{Binding LocalPath}" Foreground="Gray" FontSize="12" Margin="20,4,0,0"/>
                                                            <TextBlock Text="{Binding PrimaryLanguage}" Foreground="Gray" FontSize="10" Margin="20,2,0,0"/>
                                                        </StackPanel>

                                                        <!-- æ“ä½œæŒ‰é’® -->
                                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                                            <Button Classes="ActionButton ConfigButton" 
                                                                    Command="{Binding $parent[UserControl].((vm:ProjectLauncherViewModel)DataContext).ConfigureProjectCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    ToolTip.Tip="é…ç½®">
                                                                <TextBlock Text="âš™ï¸" FontSize="12"/>
                                                            </Button>
                                                            <Button Classes="ActionButton" 
                                                                    Content="é€‰æ‹©"
                                                                    Command="{Binding $parent[UserControl].((vm:ProjectLauncherViewModel)DataContext).LoadProjectsCommand}"
                                                                    CommandParameter="{Binding}"/>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Grid>
                            </ScrollViewer>
                        </Grid>
                    </Border>

                    <!-- åˆ†éš”çº¿ -->
                    <GridSplitter Grid.Column="1" Width="4" Background="Transparent" ResizeDirection="Columns"/>

                    <!-- æŽ§åˆ¶é¢æ¿ -->
                    <Border Grid.Column="2" Classes="ProjectCard" Margin="8,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- å¯åŠ¨é…ç½® -->
                            <StackPanel Grid.Row="0" Margin="0,0,0,16">
                                <TextBlock Text="å¯åŠ¨é…ç½®" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>
                                
                                <TextBlock Text="çŽ¯å¢ƒ:" FontWeight="SemiBold" Margin="0,0,0,4"/>
                                <ComboBox ItemsSource="{Binding Environments}"
                                          SelectedItem="{Binding SelectedEnvironment}"
                                          HorizontalAlignment="Stretch"/>
                                
                                <TextBlock Text="è‡ªå®šä¹‰ç«¯å£:" FontWeight="SemiBold" Margin="0,12,0,4"/>
                                <NumericUpDown Value="{Binding CustomPort}" 
                                               Minimum="1000" Maximum="65535"
                                               Watermark="è‡ªåŠ¨åˆ†é…"
                                               HorizontalAlignment="Stretch"/>

                                <Button Classes="ActionButton StartButton" 
                                        Content="ðŸš€ å¯åŠ¨é¡¹ç›®"
                                        Command="{Binding StartProjectCommand}"
                                        HorizontalAlignment="Stretch"
                                        Margin="0,16,0,0"/>
                            </StackPanel>

                            <!-- å¿«æ·æ“ä½œ -->
                            <StackPanel Grid.Row="1" Margin="0,0,0,16">
                                <TextBlock Text="å¿«æ·æ“ä½œ" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>
                                
                                <Button Classes="ActionButton" Content="ðŸ”„ åˆ·æ–°é¡¹ç›®" 
                                        Command="{Binding RefreshCommand}"
                                        HorizontalAlignment="Stretch" Margin="0,0,0,4"/>
                                <Button Classes="ActionButton" Content="ðŸ§¹ æ¸…ç†ç«¯å£" 
                                        Command="{Binding CleanupPortsCommand}"
                                        HorizontalAlignment="Stretch" Margin="0,0,0,4"/>
                            </StackPanel>

                            <!-- é¡¹ç›®ä¿¡æ¯ -->
                            <StackPanel Grid.Row="2" Margin="0,0,0,16" IsVisible="{Binding SelectedProject, Converter={x:Static ObjectConverters.IsNotNull}}">
                                <TextBlock Text="é€‰ä¸­é¡¹ç›®" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>
                                
                                <TextBlock Text="{Binding SelectedProject.Name}" FontWeight="SemiBold"/>
                                <TextBlock Text="{Binding SelectedProject.ProjectType}" Foreground="Gray" FontSize="12"/>
                                <TextBlock Text="{Binding SelectedProject.LocalPath}" Foreground="Gray" FontSize="10" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- è¿è¡Œç›‘æŽ§æ ‡ç­¾é¡µ -->
            <TabItem Header="è¿è¡Œç›‘æŽ§">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="1*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="1*"/>
                    </Grid.RowDefinitions>

                    <!-- è¿è¡Œä¸­çš„é¡¹ç›® -->
                    <Border Grid.Row="0" Classes="ProjectCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Text="è¿è¡Œä¸­çš„é¡¹ç›®" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>

                            <ScrollViewer Grid.Row="1">
                                <Grid>
                                    <!-- è¿è¡Œé¡¹ç›®åŠ è½½æŒ‡ç¤ºå™¨ -->
                                    <StackPanel IsVisible="{Binding IsRunningProjectsLoading}" 
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"
                                               Margin="20">
                                        <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                                        <TextBlock Text="æ­£åœ¨åŠ è½½è¿è¡ŒçŠ¶æ€..." HorizontalAlignment="Center" Margin="0,8,0,0"/>
                                    </StackPanel>

                                    <!-- ç©ºçŠ¶æ€æç¤º -->
                                    <StackPanel IsVisible="{Binding RunningProjects.Count, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}"
                                               HorizontalAlignment="Center" 
                                               VerticalAlignment="Center"
                                               Margin="20">
                                        <TextBlock Text="ðŸš€" FontSize="48" HorizontalAlignment="Center" Opacity="0.5"/>
                                        <TextBlock Text="æš‚æ— è¿è¡Œä¸­çš„é¡¹ç›®" HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.7"/>
                                        <TextBlock Text="ç‚¹å‡»å¯åŠ¨æŒ‰é’®æ¥å¯åŠ¨é¡¹ç›®" HorizontalAlignment="Center" FontSize="12" Opacity="0.5"/>
                                    </StackPanel>

                                    <!-- è¿è¡Œé¡¹ç›®åˆ—è¡¨ -->
                                    <ItemsControl ItemsSource="{Binding RunningProjects}" IsVisible="{Binding RunningProjects.Count, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=0}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate x:DataType="vm:LaunchedProjectViewModel">
                                                <Border Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
                                                        CornerRadius="6" Padding="12" Margin="0,0,0,8">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>

                                                        <StackPanel Grid.Column="0">
                                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                                <Ellipse Classes="StatusIndicator Running"/>
                                                                <TextBlock Text="{Binding ProjectName}" FontWeight="SemiBold"/>
                                                                <Border Background="#28a745" CornerRadius="3" Padding="4,2">
                                                                    <TextBlock Text="{Binding Status}" Foreground="White" FontSize="10"/>
                                                                </Border>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal" Spacing="16" Margin="20,4,0,0">
                                                                <TextBlock Text="{Binding CurrentEnvironment}" Foreground="Gray" FontSize="12"/>
                                                                <TextBlock Text="{Binding CurrentPort, StringFormat='Port: {0}'}" Foreground="Gray" FontSize="12"/>
                                                                <TextBlock Text="{Binding ProcessId, StringFormat='PID: {0}'}" Foreground="Gray" FontSize="12"/>
                                                            </StackPanel>
                                                        </StackPanel>

                                                        <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="4">
                                                            <Button Classes="ActionButton" 
                                                                    Command="{Binding $parent[UserControl].((vm:ProjectLauncherViewModel)DataContext).ViewLogsCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    ToolTip.Tip="æŸ¥çœ‹æ—¥å¿—">
                                                                <TextBlock Text="ðŸ“‹" FontSize="12"/>
                                                            </Button>
                                                            <Button Classes="ActionButton" 
                                                                    Command="{Binding $parent[UserControl].((vm:ProjectLauncherViewModel)DataContext).RestartProjectCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    ToolTip.Tip="é‡å¯">
                                                                <TextBlock Text="ðŸ”„" FontSize="12"/>
                                                            </Button>
                                                            <Button Classes="ActionButton StopButton" 
                                                                    Command="{Binding $parent[UserControl].((vm:ProjectLauncherViewModel)DataContext).StopProjectCommand}"
                                                                    CommandParameter="{Binding}"
                                                                    ToolTip.Tip="åœæ­¢">
                                                                <TextBlock Text="â¹ï¸" FontSize="12"/>
                                                            </Button>
                                                        </StackPanel>
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </Grid>
                            </ScrollViewer>
                        </Grid>
                    </Border>

                    <!-- åˆ†éš”çº¿ -->
                    <GridSplitter Grid.Row="1" Height="4" Background="Transparent" ResizeDirection="Rows"/>

                    <!-- é¡¹ç›®æ—¥å¿— -->
                    <Border Grid.Row="2" Classes="ProjectCard">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Grid Grid.Row="0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0" Text="é¡¹ç›®æ—¥å¿—" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>
                                <Button Grid.Column="1" Classes="ActionButton" Command="{Binding ClearLogsCommand}" Content="æ¸…ç©º"/>
                            </Grid>

                            <ScrollViewer Grid.Row="1" Background="Black">
                                <ItemsControl ItemsSource="{Binding ProjectLogs}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" 
                                                       Foreground="LightGreen" 
                                                       FontFamily="Consolas" 
                                                       FontSize="11" 
                                                       Margin="4,1"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </ScrollViewer>
                        </Grid>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ç«¯å£ç®¡ç†æ ‡ç­¾é¡µ -->
            <TabItem Header="ç«¯å£ç®¡ç†">
                <Border Classes="ProjectCard">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Text="ç«¯å£åˆ†é…çŠ¶æ€" FontWeight="SemiBold" FontSize="16" Margin="0,0,0,12"/>

                        <!-- ç«¯å£åŠ è½½æŒ‡ç¤ºå™¨ -->
                        <StackPanel Grid.Row="1" IsVisible="{Binding IsPortsLoading}" 
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center"
                                   Margin="20">
                            <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                            <TextBlock Text="æ­£åœ¨åŠ è½½ç«¯å£ä¿¡æ¯..." HorizontalAlignment="Center" Margin="0,8,0,0"/>
                        </StackPanel>

                        <!-- ç©ºçŠ¶æ€æç¤º -->
                        <StackPanel Grid.Row="1" IsVisible="{Binding PortAllocations.Count, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}"
                                   HorizontalAlignment="Center" 
                                   VerticalAlignment="Center"
                                   Margin="20">
                            <TextBlock Text="ðŸ”Œ" FontSize="48" HorizontalAlignment="Center" Opacity="0.5"/>
                            <TextBlock Text="æš‚æ— ç«¯å£åˆ†é…" HorizontalAlignment="Center" Margin="0,8,0,0" Opacity="0.7"/>
                            <TextBlock Text="å¯åŠ¨é¡¹ç›®åŽå°†æ˜¾ç¤ºç«¯å£åˆ†é…ä¿¡æ¯" HorizontalAlignment="Center" FontSize="12" Opacity="0.5"/>
                        </StackPanel>

                        <!-- ç«¯å£åˆ—è¡¨ -->
                        <DataGrid Grid.Row="1" ItemsSource="{Binding PortAllocations}" 
                                  AutoGenerateColumns="False" IsReadOnly="True"
                                  IsVisible="{Binding PortAllocations.Count, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=0}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ç«¯å£" Binding="{Binding Port}" Width="80"/>
                                <DataGridTextColumn Header="çŠ¶æ€" Binding="{Binding Status}" Width="80"/>
                                <DataGridTextColumn Header="é¡¹ç›®" Binding="{Binding ProjectName}" Width="200"/>
                                <DataGridTextColumn Header="æè¿°" Binding="{Binding Description}" Width="*"/>
                                <DataGridTextColumn Header="æœ€åŽä½¿ç”¨" Binding="{Binding LastUsedAt, StringFormat={}{0:yyyy-MM-dd HH:mm}}" Width="150"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </TabItem>
        </TabControl>

        <!-- çŠ¶æ€æ  -->
        <Border Grid.Row="2" Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
                BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                BorderThickness="0,1,0,0" Padding="16,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}" VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="16">
                    <TextBlock Text="{Binding ProjectSources.Count, StringFormat='é¡¹ç›®: {0}'}" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding RunningProjects.Count, StringFormat='è¿è¡Œä¸­: {0}'}" VerticalAlignment="Center"/>
                    <TextBlock Text="{Binding PortAllocations.Count, StringFormat='ç«¯å£å ç”¨: {0}'}" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- æ“ä½œåŠ è½½æŒ‡ç¤ºå™¨ (ä»…ç”¨äºŽå…·ä½“æ“ä½œï¼Œå¦‚å¯åŠ¨ã€åœæ­¢é¡¹ç›®) -->
        <Border Grid.RowSpan="3" Background="#80000000" IsVisible="{Binding IsLoading}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                <ProgressBar IsIndeterminate="True" Width="200" Height="4"/>
                <TextBlock Text="æ­£åœ¨å¤„ç†..." Foreground="White" HorizontalAlignment="Center" Margin="0,8,0,0"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
