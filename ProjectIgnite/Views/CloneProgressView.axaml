<Window x:Class="ProjectIgnite.Views.CloneProgressView"
        xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:converters="using:ProjectIgnite.Converters"
        mc:Ignorable="d"
        Title="克隆项目" Height="500" Width="600"
        WindowStartupLocation="CenterOwner"
        CanResize="False"
        ShowInTaskbar="False">
    
    <Window.Resources>
        <converters:FileSizeConverter x:Key="FileSizeConverter"/>
        <converters:NumberFormatConverter x:Key="NumberFormatConverter"/>
        <converters:StringToVisibilityConverter x:Key="StringToVisibilityConverter"/>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>
    
    <Window.Styles>
        <!-- 进度条样式 -->
        <Style Selector="ProgressBar.ModernProgressBar">
            <Setter Property="Height" Value="8"/>
            <Setter Property="Background" Value="#E0E0E0"/>
            <Setter Property="Foreground" Value="#2196F3"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="CornerRadius" Value="4"/>
        </Style>
        
        <!-- 按钮样式 -->
        <Style Selector="Button.ActionButton">
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="CornerRadius" Value="6"/>
        </Style>
        
        <!-- 主要按钮样式 -->
        <Style Selector="Button.PrimaryButton">
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        
        <!-- 次要按钮样式 -->
        <Style Selector="Button.SecondaryButton">
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="BorderBrush" Value="#CCCCCC"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        
        <!-- 危险按钮样式 -->
        <Style Selector="Button.DangerButton">
            <Setter Property="Height" Value="36"/>
            <Setter Property="MinWidth" Value="100"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="16,0"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Medium"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Background" Value="#F44336"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </Window.Styles>
    
    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题区域 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,24">
            <TextBlock Text="克隆项目" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       Foreground="#333333" 
                       Margin="0,0,0,8"/>
            <TextBlock Text="{Binding ProjectName}" 
                       FontSize="16" 
                       Foreground="#666666"/>
        </StackPanel>
        
        <!-- 主要内容区域 -->
        <ScrollViewer Grid.Row="1" 
                      VerticalScrollBarVisibility="Auto" 
                      HorizontalScrollBarVisibility="Disabled">
            <StackPanel>
                <!-- 项目信息 -->
                <Border Background="#F8F9FA" 
                        CornerRadius="8" 
                        Padding="16" 
                        Margin="0,0,0,16">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Grid.Column="0" 
                                   Text="Git URL:" 
                                   FontWeight="Medium" 
                                   Margin="0,0,12,8" 
                                   VerticalAlignment="Top"/>
                        <TextBlock Grid.Row="0" Grid.Column="1" 
                                   Text="{Binding GitUrl}" 
                                   TextWrapping="Wrap" 
                                   Margin="0,0,0,8"/>
                        
                        <TextBlock Grid.Row="1" Grid.Column="0" 
                                   Text="本地路径:" 
                                   FontWeight="Medium" 
                                   Margin="0,0,12,8" 
                                   VerticalAlignment="Top"/>
                        <TextBlock Grid.Row="1" Grid.Column="1" 
                                   Text="{Binding LocalPath}" 
                                   TextWrapping="Wrap" 
                                   Margin="0,0,0,8"/>
                        
                        <TextBlock Grid.Row="2" Grid.Column="0" 
                                   Text="分支:" 
                                   FontWeight="Medium" 
                                   Margin="0,0,12,0" 
                                   VerticalAlignment="Top"/>
                        <TextBlock Grid.Row="2" Grid.Column="1" 
                                   Text="{Binding Branch}" 
                                   Margin="0,0,0,0"/>
                    </Grid>
                </Border>
                
                <!-- 克隆进度 -->
                <Border Background="White" 
                        BorderBrush="#E0E0E0" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        Padding="16" 
                        Margin="0,0,0,16">
                    <StackPanel>
                        <TextBlock Text="克隆进度" 
                                   FontSize="16" 
                                   FontWeight="Medium" 
                                   Margin="0,0,0,12"/>
                        
                        <!-- 总体进度 -->
                        <Grid Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <ProgressBar Grid.Column="0" 
                                         Classes="ModernProgressBar" 
                                         Value="{Binding OverallProgress}" 
                                         Maximum="100" 
                                         Margin="0,0,12,0"/>
                            <TextBlock Grid.Column="1" 
                                       Text="{Binding OverallProgress, StringFormat={}{0:F1}%}" 
                                       FontWeight="Medium" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                        
                        <!-- 当前状态 -->
                        <TextBlock Text="{Binding CurrentStatus}" 
                                   FontSize="14" 
                                   Foreground="#666666" 
                                   Margin="0,0,0,8"/>
                        
                        <!-- 详细信息 -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <StackPanel Grid.Row="0" Grid.Column="0" 
                                        Orientation="Horizontal" 
                                        Margin="0,0,0,4">
                                <TextBlock Text="已接收对象: " 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                                <TextBlock Text="{Binding ReceivedObjects, Converter={StaticResource NumberFormatConverter}}" 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                            </StackPanel>
                            <StackPanel Grid.Row="0" Grid.Column="1" 
                                        Orientation="Horizontal" 
                                        Margin="0,0,0,4">
                                <TextBlock Text="总对象数: " 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                                <TextBlock Text="{Binding TotalObjects, Converter={StaticResource NumberFormatConverter}}" 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                            </StackPanel>
                            
                            <StackPanel Grid.Row="1" Grid.Column="0" 
                                        Orientation="Horizontal" 
                                        Margin="0,0,0,4">
                                <TextBlock Text="已接收: " 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                                <TextBlock Text="{Binding ReceivedBytes, Converter={StaticResource FileSizeConverter}}" 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                            </StackPanel>
                            <StackPanel Grid.Row="1" Grid.Column="1" 
                                        Orientation="Horizontal" 
                                        Margin="0,0,0,4">
                                <TextBlock Text="速度: " 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                                <TextBlock Text="{Binding Speed, Converter={StaticResource FileSizeConverter}}" 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                                <TextBlock Text="/s" 
                                           FontSize="12" 
                                           Foreground="#888888"/>
                            </StackPanel>
                            
                            <TextBlock Grid.Row="2" Grid.Column="0" 
                                       Text="{Binding ElapsedTime, StringFormat=已用时间: {0:mm\\:ss}}" 
                                       FontSize="12" 
                                       Foreground="#888888"/>
                            <TextBlock Grid.Row="2" Grid.Column="1" 
                                       Text="{Binding EstimatedTime, StringFormat=预计剩余: {0:mm\\:ss}}" 
                                       FontSize="12" 
                                       Foreground="#888888"
                                       IsVisible="{Binding EstimatedTime, Converter={StaticResource StringToVisibilityConverter}}"/>
                        </Grid>
                    </StackPanel>
                </Border>
                
                <!-- 语言分析进度 -->
                <Border Background="White" 
                        BorderBrush="#E0E0E0" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        Padding="16" 
                        IsVisible="{Binding IsAnalyzing, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="语言分析" 
                                   FontSize="16" 
                                   FontWeight="Medium" 
                                   Margin="0,0,0,12"/>
                        
                        <Grid Margin="0,0,0,8">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <ProgressBar Grid.Column="0" 
                                         Classes="ModernProgressBar" 
                                         IsIndeterminate="True" 
                                         Margin="0,0,12,0"/>
                            <TextBlock Grid.Column="1" 
                                       Text="分析中..." 
                                       FontWeight="Medium" 
                                       VerticalAlignment="Center"/>
                        </Grid>
                        
                        <TextBlock Text="{Binding AnalysisStatus}" 
                                   FontSize="14" 
                                   Foreground="#666666"/>
                    </StackPanel>
                </Border>
                
                <!-- 错误信息 -->
                <Border Background="#FFEBEE" 
                        BorderBrush="#F44336" 
                        BorderThickness="1" 
                        CornerRadius="8" 
                        Padding="16" 
                        Margin="0,16,0,0" 
                        IsVisible="{Binding ErrorMessage, Converter={StaticResource StringToVisibilityConverter}}">
                    <StackPanel>
                        <TextBlock Text="错误信息" 
                                   FontSize="16" 
                                   FontWeight="Medium" 
                                   Foreground="#F44336" 
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="{Binding ErrorMessage}" 
                                   TextWrapping="Wrap" 
                                   Foreground="#D32F2F"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>
        
        <!-- 按钮区域 -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,24,0,0">
            <Button Content="取消" 
                    Classes="SecondaryButton" 
                    Command="{Binding CancelCommand}" 
                    IsVisible="{Binding CanCancel, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <Button Content="重试" 
                    Classes="SecondaryButton" 
                    Command="{Binding RetryCommand}" 
                    IsVisible="{Binding CanRetry, Converter={StaticResource BooleanToVisibilityConverter}}"/>
            <Button Content="完成" 
                    Classes="PrimaryButton" 
                    Command="{Binding CompleteCommand}" 
                    IsVisible="{Binding IsCompleted, Converter={StaticResource BooleanToVisibilityConverter}}"/>
        </StackPanel>
    </Grid>
</Window>
